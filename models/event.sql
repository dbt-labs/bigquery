
{% set columns = [
    '_fivetran_synced',
    'app_id',
    'br_colordepth',
    'br_cookies',
    'br_family',
    'br_features_director',
    'br_features_flash',
    'br_features_gears',
    'br_features_java',
    'br_features_pdf',
    'br_features_quicktime',
    'br_features_realplayer',
    'br_features_silverlight',
    'br_features_windowsmedia',
    'br_lang',
    'br_name',
    'br_renderengine',
    'br_type',
    'br_version',
    'br_viewheight',
    'collector_tstamp',
    'doc_charset',
    'doc_height',
    'doc_width',
    'domain_sessionid',
    'domain_sessionidx',
    'domain_userid',
    'dvce_ismobile',
    'dvce_screenheight',
    'dvce_sent_tstamp',
    'dvce_tstamp',
    'dvce_type',
    'event',
    'event_format',
    'event_id',
    'event_name',
    'event_vendor',
    'event_version',
    'geo_city',
    'geo_country',
    'geo_latitude',
    'geo_longitude',
    'geo_region',
    'geo_region_name',
    'geo_timezone',
    'geo_zipcode',
    'mkt_campaign',
    'mkt_content',
    'mkt_medium',
    'mkt_source',
    'mkt_term',
    'name_tracker',
    'network_userid',
    'os_family',
    'os_manufacturer',
    'os_name',
    'os_timezone',
    'page_referrer',
    'page_title',
    'page_url',
    'page_urlfragment',
    'page_urlhost',
    'page_urlpath',
    'page_urlport',
    'page_urlquery',
    'page_urlscheme',
    'platform',
    'pp_xoffset_max',
    'pp_xoffset_min',
    'pp_yoffset_max',
    'pp_yoffset_min',
    'refr_medium',
    'refr_source',
    'refr_term',
    'refr_urlfragment',
    'refr_urlhost',
    'refr_urlpath',
    'refr_urlport',
    'refr_urlquery',
    'refr_urlscheme',
    'se_action',
    'se_category',
    'se_label',
    'se_property',
    'se_value',
    'sequence_number',
    'ti_category',
    'ti_currency',
    'ti_name',
    'ti_orderid',
    'ti_price',
    'ti_quantity',
    'ti_sku',
    'tr_affiliation',
    'tr_city',
    'tr_country',
    'tr_currency',
    'tr_orderid',
    'tr_shipping',
    'tr_state',
    'tr_tax',
    'tr_total',
    'txn_id',
    'user_fingerprint',
    'user_id',
    'user_ipaddress',
    'useragent',
    'v_collector',
    'v_tracker'
] %}


{{
    config(
        materialized='make_partitioned_table',
        from_table='snowplow.event',
        date_field='date(collector_tstamp)',
        columns=columns,
        unique_key='event_id'
    )
}}

select * from snowplow.event
